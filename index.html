<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Proyectos KathWare</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: auto;
      padding: 2rem;
      background-color: #fff;
      color: #111;
    }

    h1, h2 {
      text-align: center;
    }

    .proyecto {
      background-color: #f0f4f8;
      border-left: 5px solid #007bff;
      padding: 1rem;
      margin-bottom: 2rem;
      border-radius: 6px;
    }

    .proyecto h3 {
      margin-top: 0;
    }

    .proyecto a {
      color: #007bff;
      text-decoration: none;
    }

    .proyecto a:hover {
      text-decoration: underline;
    }

    .markdown {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background-color: #ffffff;
      border-left: 3px solid #aaa;
    }

    .enlace-blog {
      text-align: center;
      margin-bottom: 2rem;
      font-size: 1rem;
    }

    footer {
      text-align: center;
      margin-top: 3rem;
      font-size: 0.95rem;
      color: #333;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
</head>
<body>

  <p class="enlace-blog">
    También podés visitar:  
    <a href="https://kathware.com.ar/proyectos/" target="_blank">Proyectos en el blog de KathWare</a>
  </p>

  <h2>Proyectos activos en GitHub</h2>
  <div id="versiones">Cargando proyectos desde GitHub...</div>

  <script>
    async function obtenerRepositorios() {
      const usuarioGitHub = "dragonmoon1522";
      const repoPrincipal = "kathware";
      const apiRepos = `https://api.github.com/users/${usuarioGitHub}/repos`;

      try {
        const respuesta = await fetch(apiRepos);
        if (!respuesta.ok) throw new Error("No se pudo obtener la lista de repositorios.");
        const repos = await respuesta.json();
        const proyectosConInfo = [];

        for (let repo of repos) {
          const repoBaseURL = `https://raw.githubusercontent.com/${usuarioGitHub}/${repo.name}/main/`;
          const repoPageURL = `https://${usuarioGitHub}.github.io/${repo.name}/`;
          const archivos = ["README.md", "readme.md", "VERSION.md", "version.md"];
          const converter = new showdown.Converter({ headerLevelStart: 3 });

          let readmeHtml = "", versionHtml = "";

          for (let archivo of archivos) {
            try {
              const respuestaArchivo = await fetch(repoBaseURL + archivo);
              if (respuestaArchivo.ok) {
                const texto = await respuestaArchivo.text();
                if (archivo.toLowerCase().includes("readme")) {
                  readmeHtml = converter.makeHtml(texto);
                }
                if (archivo.toLowerCase().includes("version")) {
                  versionHtml = converter.makeHtml(texto);
                }
              }
            } catch (e) {}
          }

          proyectosConInfo.push({
            nombre: repo.name === repoPrincipal ? "KathWare — Núcleo del ecosistema" : repo.name.replace(/-/g, " "),
            url: repoPageURL,
            readme: readmeHtml,
            version: versionHtml
          });
        }

        cargarProyectos(proyectosConInfo);
      } catch (error) {
        document.getElementById("versiones").innerText = "No se pudo cargar la lista de proyectos.";
      }
    }

    function cargarProyectos(proyectos) {
      const contenedor = document.getElementById("versiones");
      contenedor.innerHTML = "";

      proyectos.forEach(proyecto => {
        const seccion = document.createElement("div");
        seccion.classList.add("proyecto");

        seccion.innerHTML = `
          <h3><a href="${proyecto.url}" target="_blank">${proyecto.nombre}</a></h3>
          ${proyecto.readme ? `<div class="markdown">${proyecto.readme}</div>` : ""}
          ${proyecto.version ? `<div class="markdown">${proyecto.version}</div>` : ""}
        `;

        contenedor.appendChild(seccion);
      });
    }

    obtenerRepositorios();
  </script>

  <hr />
  <footer>
    <p>
      <a href="https://github.com/dragonmoon1522" target="_blank">Ver perfil en GitHub</a> |
      <a href="https://kathware.com.ar/contacto/" target="_blank">Contacto directo</a> |
      <a href="https://kathware.com.ar/normas-de-uso-y-licencias-de-kathware/" target="_blank">Normas de uso</a> |
      <a href="https://kathware.com.ar/lau/" target="_blank">Licencia de Accesibilidad Universal</a>
    </p>
    <p>© 2025 <strong>KathWare</strong> — hecho por Katherine Vargas</p>
  </footer>
</body>
</html>
